digraph GradleSetup {
  label="Bndtools Gradle Build Setup"
  labelloc=t
  labeljust=l

  subgraph cluster1 {
    label="Gradle Java Plugin";
    style=filled;
    fillcolor=lightgrey;
    color=black;

    subgraph cluster11 {
      label="";
      style=invis;
      compileJava          [shape=box, style=filled, fillcolor=lightcyan, label="compileJava"]
      processResources     [shape=box, style=filled, fillcolor=lightcyan, label="processResources"]
      classes              [shape=box, style=filled, fillcolor=lightcyan, label="classes"]
      jar                  [shape=box, style=filled, fillcolor=lightcyan, label="jar"]
    }

    subgraph cluster12 {
      label="";
      style=invis;
      compileTestJava      [shape=box, style=filled, fillcolor=lightcyan, label="compileTestJava"]
      processTestResources [shape=box, style=filled, fillcolor=lightcyan, label="processTestResources"]
      testClasses          [shape=box, style=filled, fillcolor=lightcyan, label="testClasses"]
      test                 [shape=box, style=filled, fillcolor=lightcyan, label="test"]
      check                [shape=box, style=filled, fillcolor=lightcyan, label="check"]
    }

    subgraph cluster13 {
      label="";
      style=invis;
      uploadArchives       [shape=box, style=filled, fillcolor=lightcyan, label="uploadArchives"]
      assemble             [shape=box, style=filled, fillcolor=lightcyan, label="assemble"]
    }

    clean                  [shape=box, style=filled, fillcolor=lightcyan, label="clean"]
    javadoc                [shape=box, style=filled, fillcolor=lightcyan, label="javadoc"]
    build                  [shape=box, style=filled, fillcolor=lightcyan, label="build"]

    compileJava          -> classes
    processResources     -> classes
    classes              -> javadoc
    classes              -> test
    classes              -> compileTestJava
    classes              -> jar
    compileTestJava      -> testClasses
    processTestResources -> testClasses
    jar                  -> uploadArchives
    jar                  -> assemble
    testClasses          -> test
    assemble             -> build
    test                 -> check
    check                -> build
  }


  subgraph cluster2 {
    label="Bndtools Tasks";
    style=filled;
    fillcolor=lightgrey;
    color=black;

    subgraph cluster21 {
      label="";
      style=invis;
      cleanBnd        [shape=box, style=filled, fillcolor=cyan, label="clean"]
      cleanNeeded     [shape=box, style=filled, fillcolor=cyan, label="cleanNeeded"]
    }

    subgraph cluster22 {
      label="";
      style=invis;
      release         [shape=box, style=filled, fillcolor=cyan, label="release"]
      releaseNeeded   [shape=box, style=filled, fillcolor=cyan, label="releaseNeeded"]
    }

    subgraph cluster23 {
      label="";
      style=invis;
      export          [shape=box, style=filled, fillcolor=cyan, label="export"]
      exportNeeded    [shape=box, style=filled, fillcolor=cyan, label="exportNeeded"]
    }

    subgraph cluster24 {
      label="";
      style=invis;
      bundle          [shape=box, style=filled, fillcolor=cyan, label="bundle"]
      bundleTest      [shape=box, style=filled, fillcolor=cyan, label="bundleTest"]
    }

    wrapper           [shape=box, style=filled, fillcolor=cyan, label="wrapper"]
    bndproperties     [shape=box, style=filled, fillcolor=cyan, label="bndproperties"]

    bundle  -> release       [color=blue]
    release -> releaseNeeded [color=blue]
    bundle  -> export        [color=blue]
    export  -> exportNeeded  [color=blue]
    bundle  -> bundleTest    [color=blue]
  }

  clean         -> cleanBnd
  bundleTest    -> check         [color=blue]
  bundle        -> test          [color=blue]
  classes       -> bundle        [color=blue]
  cleanBnd      -> cleanNeeded   [color=blue]
  bundle        -> jar           [color=blue, style=dashed]
  bundle        -> bundle        [color=red, style=dashed]
  bundle        -> compileJava   [color=red, style=dashed]
  releaseNeeded -> releaseNeeded [color=red, style=dashed]
  exportNeeded  -> exportNeeded  [color=red, style=dashed]
  cleanNeeded   -> cleanNeeded   [color=red, style=dashed]
}
